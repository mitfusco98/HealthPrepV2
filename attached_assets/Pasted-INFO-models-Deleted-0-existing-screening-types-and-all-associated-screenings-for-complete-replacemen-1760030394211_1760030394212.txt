INFO:models:Deleted 0 existing screening types and all associated screenings for complete replacement
INFO:models:Committed deletion of existing screening types
INFO:models:Processing screening type: 'Annual Physical Exam' for org 1
INFO:models:Creating new screening type: 'Annual Physical Exam' for org 1
INFO:models:Processing screening type: 'Mammogram' for org 1
ERROR:models:Error processing screening type Mammogram: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.NotNullViolation) null value in column "frequency_years" of relation "screening_type" violates not-null constraint
DETAIL:  Failing row contains (97, Annual Physical Exam, 1, ["annual physical", "wellness exam", "physical exam", "checkup"], both, 18, null, null, [], t, 1, 2025-10-09 17:17:33.346446, 2025-10-09 17:17:33.346452, null, null, null, null, null, 12, months).

[SQL: INSERT INTO screening_type (name, org_id, keywords, eligible_genders, min_age, max_age, frequency_value, frequency_unit, trigger_conditions, is_active, created_by, created_at, updated_at, fhir_search_params, epic_query_context, fhir_condition_codes, fhir_observation_codes, fhir_document_types) VALUES (%(name)s, %(org_id)s, %(keywords)s, %(eligible_genders)s, %(min_age)s, %(max_age)s, %(frequency_value)s, %(frequency_unit)s, %(trigger_conditions)s, %(is_active)s, %(created_by)s, %(created_at)s, %(updated_at)s, %(fhir_search_params)s, %(epic_query_context)s, %(fhir_condition_codes)s, %(fhir_observation_codes)s, %(fhir_document_types)s) RETURNING screening_type.id]
[parameters: {'name': 'Annual Physical Exam', 'org_id': 1, 'keywords': '["annual physical", "wellness exam", "physical exam", "checkup"]', 'eligible_genders': 'both', 'min_age': 18, 'max_age': None, 'frequency_value': 12, 'frequency_unit': 'months', 'trigger_conditions': '[]', 'is_active': True, 'created_by': 1, 'created_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 346446), 'updated_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 346452), 'fhir_search_params': None, 'epic_query_context': None, 'fhir_condition_codes': None, 'fhir_observation_codes': None, 'fhir_document_types': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
INFO:models:Processing screening type: 'Colonoscopy' for org 1
INFO:models:Creating new screening type: 'Colonoscopy' for org 1
INFO:models:Processing screening type: 'Pap Smear' for org 1
ERROR:models:Error processing screening type Pap Smear: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.NotNullViolation) null value in column "frequency_years" of relation "screening_type" violates not-null constraint
DETAIL:  Failing row contains (98, Colonoscopy, 1, ["colonoscopy", "colon screening", "colo screening", "colorectal..., both, 45, 75, null, [], t, 1, 2025-10-09 17:17:33.451287, 2025-10-09 17:17:33.451291, null, null, null, null, null, 12, months).

[SQL: INSERT INTO screening_type (name, org_id, keywords, eligible_genders, min_age, max_age, frequency_value, frequency_unit, trigger_conditions, is_active, created_by, created_at, updated_at, fhir_search_params, epic_query_context, fhir_condition_codes, fhir_observation_codes, fhir_document_types) VALUES (%(name)s, %(org_id)s, %(keywords)s, %(eligible_genders)s, %(min_age)s, %(max_age)s, %(frequency_value)s, %(frequency_unit)s, %(trigger_conditions)s, %(is_active)s, %(created_by)s, %(created_at)s, %(updated_at)s, %(fhir_search_params)s, %(epic_query_context)s, %(fhir_condition_codes)s, %(fhir_observation_codes)s, %(fhir_document_types)s) RETURNING screening_type.id]
[parameters: {'name': 'Colonoscopy', 'org_id': 1, 'keywords': '["colonoscopy", "colon screening", "colo screening", "colorectal screening"]', 'eligible_genders': 'both', 'min_age': 45, 'max_age': 75, 'frequency_value': 12, 'frequency_unit': 'months', 'trigger_conditions': '[]', 'is_active': True, 'created_by': 1, 'created_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 451287), 'updated_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 451291), 'fhir_search_params': None, 'epic_query_context': None, 'fhir_condition_codes': None, 'fhir_observation_codes': None, 'fhir_document_types': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
INFO:models:Processing screening type: 'A1C Test' for org 1
INFO:models:Creating new screening type: 'A1C Test' for org 1
INFO:models:Processing screening type: 'A1C Test (Non-Diabetic)' for org 1
ERROR:models:Error processing screening type A1C Test (Non-Diabetic): (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.NotNullViolation) null value in column "frequency_years" of relation "screening_type" violates not-null constraint
DETAIL:  Failing row contains (99, A1C Test, 1, ["a1c", "hemoglobin a1c", "hba1c", "glycohemoglobin"], both, 18, null, null, ["diabetes"], t, 1, 2025-10-09 17:17:33.550817, 2025-10-09 17:17:33.550822, null, null, null, null, null, 1, months).

[SQL: INSERT INTO screening_type (name, org_id, keywords, eligible_genders, min_age, max_age, frequency_value, frequency_unit, trigger_conditions, is_active, created_by, created_at, updated_at, fhir_search_params, epic_query_context, fhir_condition_codes, fhir_observation_codes, fhir_document_types) VALUES (%(name)s, %(org_id)s, %(keywords)s, %(eligible_genders)s, %(min_age)s, %(max_age)s, %(frequency_value)s, %(frequency_unit)s, %(trigger_conditions)s, %(is_active)s, %(created_by)s, %(created_at)s, %(updated_at)s, %(fhir_search_params)s, %(epic_query_context)s, %(fhir_condition_codes)s, %(fhir_observation_codes)s, %(fhir_document_types)s) RETURNING screening_type.id]
[parameters: {'name': 'A1C Test', 'org_id': 1, 'keywords': '["a1c", "hemoglobin a1c", "hba1c", "glycohemoglobin"]', 'eligible_genders': 'both', 'min_age': 18, 'max_age': None, 'frequency_value': 1, 'frequency_unit': 'months', 'trigger_conditions': '["diabetes"]', 'is_active': True, 'created_by': 1, 'created_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 550817), 'updated_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 550822), 'fhir_search_params': None, 'epic_query_context': None, 'fhir_condition_codes': None, 'fhir_observation_codes': None, 'fhir_document_types': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
INFO:models:Processing screening type: 'Lipid Panel' for org 1
INFO:models:Creating new screening type: 'Lipid Panel' for org 1
INFO:models:Processing screening type: 'Bone Density Scan' for org 1
ERROR:models:Error processing screening type Bone Density Scan: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.NotNullViolation) null value in column "frequency_years" of relation "screening_type" violates not-null constraint
DETAIL:  Failing row contains (100, Lipid Panel, 1, ["lipid panel", "cholesterol", "lipids", "lipid profile"], both, 20, null, null, [], t, 1, 2025-10-09 17:17:33.654634, 2025-10-09 17:17:33.65464, null, null, null, null, null, 12, months).

[SQL: INSERT INTO screening_type (name, org_id, keywords, eligible_genders, min_age, max_age, frequency_value, frequency_unit, trigger_conditions, is_active, created_by, created_at, updated_at, fhir_search_params, epic_query_context, fhir_condition_codes, fhir_observation_codes, fhir_document_types) VALUES (%(name)s, %(org_id)s, %(keywords)s, %(eligible_genders)s, %(min_age)s, %(max_age)s, %(frequency_value)s, %(frequency_unit)s, %(trigger_conditions)s, %(is_active)s, %(created_by)s, %(created_at)s, %(updated_at)s, %(fhir_search_params)s, %(epic_query_context)s, %(fhir_condition_codes)s, %(fhir_observation_codes)s, %(fhir_document_types)s) RETURNING screening_type.id]
[parameters: {'name': 'Lipid Panel', 'org_id': 1, 'keywords': '["lipid panel", "cholesterol", "lipids", "lipid profile"]', 'eligible_genders': 'both', 'min_age': 20, 'max_age': None, 'frequency_value': 12, 'frequency_unit': 'months', 'trigger_conditions': '[]', 'is_active': True, 'created_by': 1, 'created_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 654634), 'updated_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 654640), 'fhir_search_params': None, 'epic_query_context': None, 'fhir_condition_codes': None, 'fhir_observation_codes': None, 'fhir_document_types': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
INFO:models:Processing screening type: 'Blood Pressure Check' for org 1
INFO:models:Creating new screening type: 'Blood Pressure Check' for org 1
INFO:models:Processing screening type: 'Blood Pressure Check (Hypertensive)' for org 1
ERROR:models:Error processing screening type Blood Pressure Check (Hypertensive): (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.NotNullViolation) null value in column "frequency_years" of relation "screening_type" violates not-null constraint
DETAIL:  Failing row contains (101, Blood Pressure Check, 1, ["blood pressure", "bp check", "hypertension screening"], both, 18, null, null, [], t, 1, 2025-10-09 17:17:33.754528, 2025-10-09 17:17:33.754534, null, null, null, null, null, 12, months).

[SQL: INSERT INTO screening_type (name, org_id, keywords, eligible_genders, min_age, max_age, frequency_value, frequency_unit, trigger_conditions, is_active, created_by, created_at, updated_at, fhir_search_params, epic_query_context, fhir_condition_codes, fhir_observation_codes, fhir_document_types) VALUES (%(name)s, %(org_id)s, %(keywords)s, %(eligible_genders)s, %(min_age)s, %(max_age)s, %(frequency_value)s, %(frequency_unit)s, %(trigger_conditions)s, %(is_active)s, %(created_by)s, %(created_at)s, %(updated_at)s, %(fhir_search_params)s, %(epic_query_context)s, %(fhir_condition_codes)s, %(fhir_observation_codes)s, %(fhir_document_types)s) RETURNING screening_type.id]
[parameters: {'name': 'Blood Pressure Check', 'org_id': 1, 'keywords': '["blood pressure", "bp check", "hypertension screening"]', 'eligible_genders': 'both', 'min_age': 18, 'max_age': None, 'frequency_value': 12, 'frequency_unit': 'months', 'trigger_conditions': '[]', 'is_active': True, 'created_by': 1, 'created_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 754528), 'updated_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 754534), 'fhir_search_params': None, 'epic_query_context': None, 'fhir_condition_codes': None, 'fhir_observation_codes': None, 'fhir_document_types': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
INFO:models:Processing screening type: 'Eye Exam' for org 1
INFO:models:Creating new screening type: 'Eye Exam' for org 1
INFO:models:Processing screening type: 'Diabetic Eye Exam' for org 1
ERROR:models:Error processing screening type Diabetic Eye Exam: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.NotNullViolation) null value in column "frequency_years" of relation "screening_type" violates not-null constraint
DETAIL:  Failing row contains (102, Eye Exam, 1, ["eye exam", "ophthalmology", "vision screening", "eye screening..., both, 18, null, null, [], t, 1, 2025-10-09 17:17:33.858132, 2025-10-09 17:17:33.858138, null, null, null, null, null, 12, months).

[SQL: INSERT INTO screening_type (name, org_id, keywords, eligible_genders, min_age, max_age, frequency_value, frequency_unit, trigger_conditions, is_active, created_by, created_at, updated_at, fhir_search_params, epic_query_context, fhir_condition_codes, fhir_observation_codes, fhir_document_types) VALUES (%(name)s, %(org_id)s, %(keywords)s, %(eligible_genders)s, %(min_age)s, %(max_age)s, %(frequency_value)s, %(frequency_unit)s, %(trigger_conditions)s, %(is_active)s, %(created_by)s, %(created_at)s, %(updated_at)s, %(fhir_search_params)s, %(epic_query_context)s, %(fhir_condition_codes)s, %(fhir_observation_codes)s, %(fhir_document_types)s) RETURNING screening_type.id]
[parameters: {'name': 'Eye Exam', 'org_id': 1, 'keywords': '["eye exam", "ophthalmology", "vision screening", "eye screening"]', 'eligible_genders': 'both', 'min_age': 18, 'max_age': None, 'frequency_value': 12, 'frequency_unit': 'months', 'trigger_conditions': '[]', 'is_active': True, 'created_by': 1, 'created_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 858132), 'updated_at': datetime.datetime(2025, 10, 9, 17, 17, 33, 858138), 'fhir_search_params': None, 'epic_query_context': None, 'fhir_condition_codes': None, 'fhir_observation_codes': None, 'fhir_document_types': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
INFO:models:Successfully imported 6 and updated 0 screening types
INFO:routes.admin_routes:Preset Primary Care Screening Package applied - triggering screening refresh to create screening items
INFO:services.screening_refresh_service:ScreeningRefreshService initialized for organization 1 - LOCAL PROCESSING ONLY
INFO:services.screening_refresh_service:Starting screening refresh for EXISTING data only - NO Epic calls
INFO:services.screening_refresh_service:Force refresh requested