INFO:app:Startup document processing disabled for faster boot times (set STARTUP_PROCESS_DOCS=true to enable)
INFO:__main__:Starting HealthPrep Medical Screening System
WARNING:werkzeug: * Debugger is active!
INFO:werkzeug: * Debugger PIN: 112-817-835
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:43:58] "GET / HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:43:59] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:43:59] "GET /static/css/medical_styles.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:43:59] "GET /static/css/medical_terminology_ui.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:43:59] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:43:59] "GET /static/js/medical_terminology.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:04] "GET /auth/logout HTTP/1.1" 302 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:04] "GET /auth/login HTTP/1.1" 200 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:04] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:04] "GET /static/css/medical_styles.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:45:04] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:04] "GET /static/css/medical_terminology_ui.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:04] "GET /static/js/medical_terminology.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:08] "POST /auth/login HTTP/1.1" 302 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:08] "GET /admin/dashboard HTTP/1.1" 302 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:10] "GET /admin/dashboard/logs HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:10] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:45:10] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:16] "GET /admin/epic/registration HTTP/1.1" 200 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:45:16] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:16] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:18] "GET /oauth/check-epic-credentials HTTP/1.1" 200 -
INFO:routes.oauth_routes:=== EPIC OAUTH AUTHORIZE DEBUG ===
INFO:routes.oauth_routes:Current user ID: 1
INFO:routes.oauth_routes:Current user username: admin
INFO:routes.oauth_routes:Current user org_id: 1
INFO:routes.oauth_routes:Current user organization object: <Organization Default Organization>
INFO:routes.oauth_routes:Session epic_org_id: 1
INFO:routes.oauth_routes:Organization ID: 1
INFO:routes.oauth_routes:Organization name: Default Organization
INFO:routes.oauth_routes:Organization epic_client_id: e57377e2-dfd5-4675-9659-58c33aa67b3f
INFO:routes.oauth_routes:================================
INFO:routes.oauth_routes:OAuth redirect URI: https://55ab1b06-006d-47ec-9b73-b827f4e0f641-00-1fje9legmrd1y.riker.replit.dev/oauth/epic-callback
INFO:routes.oauth_routes:Epic client ID: e57377e2-dfd5-4675-9659-58c33aa67b3f
INFO:routes.oauth_routes:Epic auth URL: https://fhir.epic.com/interconnect-fhir-oauth/oauth2/authorize
INFO:services.epic_session_cleanup:Preparing for scope change - org: 1, scopes: ['openid', 'fhirUser', 'launch/patient', 'patient/Patient.read', 'patient/Observation.read', 'patient/Condition.read', 'patient/DocumentReference.read']
INFO:services.epic_session_cleanup:Scope changes detected for org 1:
INFO:services.epic_session_cleanup:  Added scopes: ['patient/DocumentReference.read', 'launch/patient', 'patient/Patient.read', 'patient/Observation.read', 'patient/Condition.read']
INFO:services.epic_session_cleanup:  Removed scopes: ['user/Condition.read', 'user/CarePlan.read', 'user/Encounter.read', 'user/Observation.read', 'user/Appointment.read', 'user/List.read', 'user/DiagnosticReport.read', 'user/DocumentReference.read', 'user/Goal.read', 'user/Procedure.read', 'user/Patient.read', 'offline_access', 'user/Binary.read', 'user/AllergyIntolerance.read']
INFO:services.epic_session_cleanup:Starting Epic session cleanup for org_id: 1
INFO:services.epic_session_cleanup:Epic session cleanup completed: {'session_keys_cleared': ['epic_access_token', 'epic_refresh_token', 'epic_token_expires', 'epic_token_scopes', 'epic_patient_id', 'epic_org_id', 'epic_scope_requested'], 'database_tokens_cleared': True, 'organization_status_reset': True, 'conflicts_resolved': 1, 'success': True, 'message': 'Epic sessions cleared successfully'}
INFO:routes.oauth_routes:Scope changes detected for org 1, session cleanup performed
INFO:emr.fhir_client:Epic OAuth Parameters:
INFO:emr.fhir_client:  response_type: code
INFO:emr.fhir_client:  client_id: e57377e2-dfd5-4675-9659-58c33aa67b3f
INFO:emr.fhir_client:  redirect_uri: https://55ab1b06-006d-47ec-9b73-b827f4e0f641-00-1fje9legmrd1y.riker.replit.dev/oauth/epic-callback
INFO:emr.fhir_client:  scope: openid fhirUser patient/Patient.read patient/Condition.read patient/Observation.read patient/DocumentReference.read patient/Encounter.read patient/Appointment.read user/Patient.read user/Condition.read user/Observation.read user/DocumentReference.read user/Encounter.read
INFO:emr.fhir_client:  aud: https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4/
INFO:emr.fhir_client:  state: DeE-aN5D35EYl-shSv3S1eqnkIgvQuA3JBlN1zFlVio
INFO:emr.fhir_client:Generated Epic authorization URL: https://fhir.epic.com/interconnect-fhir-oauth/oauth2/authorize?response_type=code&client_id=e57377e2-dfd5-4675-9659-58c33aa67b3f&redirect_uri=https%3A%2F%2F55ab1b06-006d-47ec-9b73-b827f4e0f641-00-1fje9legmrd1y.riker.replit.dev%2Foauth%2Fepic-callback&scope=openid+fhirUser+patient%2FPatient.read+patient%2FCondition.read+patient%2FObservation.read+patient%2FDocumentReference.read+patient%2FEncounter.read+patient%2FAppointment.read+user%2FPatient.read+user%2FCondition.read+user%2FObservation.read+user%2FDocumentReference.read+user%2FEncounter.read&aud=https%3A%2F%2Ffhir.epic.com%2Finterconnect-fhir-oauth%2Fapi%2FFHIR%2FR4%2F&state=DeE-aN5D35EYl-shSv3S1eqnkIgvQuA3JBlN1zFlVio
INFO:routes.oauth_routes:Starting Epic OAuth flow for organization 1
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:19] "GET /oauth/epic-authorize HTTP/1.1" 302 -
INFO:routes.oauth_routes:=== Epic OAuth Callback Debug ===
INFO:routes.oauth_routes:Request URL: https://55ab1b06-006d-47ec-9b73-b827f4e0f641-00-1fje9legmrd1y.riker.replit.dev/oauth/epic-callback?code=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ1cm46b2lkOjEuMi44NDAuMTE0MzUwLjEuMTMuMC4xLjcuMy42ODg4ODQuMTAwIiwiY2xpZW50X2lkIjoiZTU3Mzc3ZTItZGZkNS00Njc1LTk2NTktNThjMzNhYTY3YjNmIiwiZXBpYy5lY2kiOiJ1cm46ZXBpYzpPcGVuLkVwaWMtY3VycmVudCIsImVwaWMubWV0YWRhdGEiOiIzbWkyNndUOVNVbWtGRmpnTmJ1OGJDVlVQMkxtRk1iVDR2X09YRklJdVp0cmJxc3hlQ0FWYzFkNFAzdEhDLUphUXdCVy1mYzhqbVc5S182c25GR2FoeU1pbnRkZmE0ZGh2eFJFNEYxVV9jN2tOWjVJZXhrVDdwRzhWMmZmMEc5YSIsImVwaWMudG9rZW50eXBlIjoiY29kZSIsImV4cCI6MTc1OTY5MDIzNiwiaWF0IjoxNzU5Njg5OTM2LCJpc3MiOiJ1cm46b2lkOjEuMi44NDAuMTE0MzUwLjEuMTMuMC4xLjcuMy42ODg4ODQuMTAwIiwianRpIjoiNDE4ZmNkMDgtZmU0NS00Y2U3LTlkYjYtZDlkMmExOWM2ODdiIiwibmJmIjoxNzU5Njg5OTM2LCJzdWIiOiJlNmF3Ni1SSnVLTzJtYnFqbGVLdmdWUTMifQ.CtCa4N7GPRoXdKMOIuqrZ5t5qXaybgwxWwXeYG7nqYvZCYB20l-_JaQV7o7EHdTX0Pz75y1lDY4wz4I-0x7lG-ZtzQVTLqzqhru7i4okge16BqUOj9YRja6iVQkqzzl6GNqdWH0FJfbBmvGAFaZJc-xaMMe-mB6A9QQqOJA9E8jLSpymUyPjOz8PMWNUl7K5WmV_qe-cllU6lA3mRUCgDUYVhwXcgHCohHWxhNfxNUFD7RqT3bsCWGP_KcJpG0l1wrWI8fs-K_AobQw4KgCeujdlaxAeOrbpBan8mS1AyhE-d3eimXwl509JA7c52qwyCUu7kGM2TRqHU2CVo91maQ&state=DeE-aN5D35EYl-shSv3S1eqnkIgvQuA3JBlN1zFlVio
INFO:routes.oauth_routes:Request method: GET
INFO:routes.oauth_routes:Request headers: {'Host': '55ab1b06-006d-47ec-9b73-b827f4e0f641-00-1fje9legmrd1y.riker.replit.dev', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7', 'Accept-Encoding': 'gzip, deflate, br', 'Accept-Language': 'en-US', 'Cookie': 'session=.eJyFUl1P3DAQ_CuRn-_An3GcN9qjUvsAbWkroQpF9npNInJOSJxTVcR_x9A7JFART-tdz-yux3NHmtDbucWZ1L_vSJFyIF0MA1mR85MltcUMw4gF_hlt9OiLNBRdhH7xWBejTR3GdLwZYNnmw3cMOGEEPJrQ-lXR2yVCe7yHrZ7xX__FPepQPXczTrucDPHVzcch-u65Tq7ur1Z57QnnltRpWjBnnSc1YeCFwmCEowIqS4MrPWhWBqYZV1YbVkIVrBGUS6-UF9QwhtxIxq1VwaDw2hluKadeGkOZ09JB0JWtlFeMVpTbUoPTRloetPaaUcsdgAn6cVrWrFnyI_bb5BTmKTRpuMGYC7p02jsjQMm8HwQECtQ5Jn3QHqx0leHKS8w8HDtobJa_Sd0W52S3Y27AKVdrRtdU_WBVLVXNqiNjeCXLA2V44mR8wozf4OnanqmNUKeX_XpuL3biguFtvPl8vfu2nIgvH_oz9vdT_6sbDg2efruB1sZrfH82V1rpl9QJb5dMwkcFch47X4S2m35mWV754b92eNMNb5jhHQ-S-wexwPIh.aOK8vg.fDU7naD18VpjNJfHJdR2YOGMQ6I', 'Referer': 'https://fhir.epic.com/', 'Sec-Fetch-Dest': 'document', 'Sec-Fetch-Mode': 'navigate', 'Sec-Fetch-Site': 'cross-site', 'Sec-Fetch-User': '?1', 'Upgrade-Insecure-Requests': '1', 'X-Forwarded-For': '69.207.59.155, 10.81.6.198', 'X-Forwarded-Proto': 'https', 'X-Replit-User-Bio': '', 'X-Replit-User-Id': '', 'X-Replit-User-Name': '', 'X-Replit-User-Profile-Image': '', 'X-Replit-User-Roles': '', 'X-Replit-User-Teams': '', 'X-Replit-User-Url': ''}
INFO:routes.oauth_routes:Query parameters received:
INFO:routes.oauth_routes:  - code: <present>
INFO:routes.oauth_routes:  - state: <present>
INFO:routes.oauth_routes:  - error: None
INFO:routes.oauth_routes:  - error_description: None
INFO:routes.oauth_routes:  - all query args: {'code': 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ1cm46b2lkOjEuMi44NDAuMTE0MzUwLjEuMTMuMC4xLjcuMy42ODg4ODQuMTAwIiwiY2xpZW50X2lkIjoiZTU3Mzc3ZTItZGZkNS00Njc1LTk2NTktNThjMzNhYTY3YjNmIiwiZXBpYy5lY2kiOiJ1cm46ZXBpYzpPcGVuLkVwaWMtY3VycmVudCIsImVwaWMubWV0YWRhdGEiOiIzbWkyNndUOVNVbWtGRmpnTmJ1OGJDVlVQMkxtRk1iVDR2X09YRklJdVp0cmJxc3hlQ0FWYzFkNFAzdEhDLUphUXdCVy1mYzhqbVc5S182c25GR2FoeU1pbnRkZmE0ZGh2eFJFNEYxVV9jN2tOWjVJZXhrVDdwRzhWMmZmMEc5YSIsImVwaWMudG9rZW50eXBlIjoiY29kZSIsImV4cCI6MTc1OTY5MDIzNiwiaWF0IjoxNzU5Njg5OTM2LCJpc3MiOiJ1cm46b2lkOjEuMi44NDAuMTE0MzUwLjEuMTMuMC4xLjcuMy42ODg4ODQuMTAwIiwianRpIjoiNDE4ZmNkMDgtZmU0NS00Y2U3LTlkYjYtZDlkMmExOWM2ODdiIiwibmJmIjoxNzU5Njg5OTM2LCJzdWIiOiJlNmF3Ni1SSnVLTzJtYnFqbGVLdmdWUTMifQ.CtCa4N7GPRoXdKMOIuqrZ5t5qXaybgwxWwXeYG7nqYvZCYB20l-_JaQV7o7EHdTX0Pz75y1lDY4wz4I-0x7lG-ZtzQVTLqzqhru7i4okge16BqUOj9YRja6iVQkqzzl6GNqdWH0FJfbBmvGAFaZJc-xaMMe-mB6A9QQqOJA9E8jLSpymUyPjOz8PMWNUl7K5WmV_qe-cllU6lA3mRUCgDUYVhwXcgHCohHWxhNfxNUFD7RqT3bsCWGP_KcJpG0l1wrWI8fs-K_AobQw4KgCeujdlaxAeOrbpBan8mS1AyhE-d3eimXwl509JA7c52qwyCUu7kGM2TRqHU2CVo91maQ', 'state': 'DeE-aN5D35EYl-shSv3S1eqnkIgvQuA3JBlN1zFlVio'}
INFO:routes.oauth_routes:Session state: DeE-aN5D35EYl-shSv3S1eqnkIgvQuA3JBlN1zFlVio
INFO:routes.oauth_routes:Session user: True
INFO:routes.oauth_routes:================================
INFO:routes.oauth_routes:=== EPIC OAUTH CALLBACK USER DEBUG ===
INFO:routes.oauth_routes:Callback current user ID: 1
INFO:routes.oauth_routes:Callback current user username: admin
INFO:routes.oauth_routes:Callback current user org_id: 1
INFO:routes.oauth_routes:Callback current user organization object: <Organization Default Organization>
INFO:routes.oauth_routes:Callback Organization ID: 1
INFO:routes.oauth_routes:Callback Organization name: Default Organization
INFO:routes.oauth_routes:Callback Organization epic_client_id: e57377e2-dfd5-4675-9659-58c33aa67b3f
INFO:routes.oauth_routes:=======================================
INFO:routes.oauth_routes:Token exchange - redirect URI: https://55ab1b06-006d-47ec-9b73-b827f4e0f641-00-1fje9legmrd1y.riker.replit.dev/oauth/epic-callback
INFO:routes.oauth_routes:Token exchange - client ID: e57377e2-dfd5-4675-9659-58c33aa67b3f
INFO:routes.oauth_routes:Token exchange - token URL: https://fhir.epic.com/interconnect-fhir-oauth/oauth2/token
INFO:emr.fhir_client:Token exchange request:
INFO:emr.fhir_client:  - URL: https://fhir.epic.com/interconnect-fhir-oauth/oauth2/token
INFO:emr.fhir_client:  - client_id: e57377e2-dfd5-4675-9659-58c33aa67b3f
INFO:emr.fhir_client:  - redirect_uri: https://55ab1b06-006d-47ec-9b73-b827f4e0f641-00-1fje9legmrd1y.riker.replit.dev/oauth/epic-callback
INFO:emr.fhir_client:  - grant_type: authorization_code
INFO:emr.fhir_client:  - code: <present>
INFO:emr.fhir_client:Token exchange response:
INFO:emr.fhir_client:  - status_code: 200
INFO:emr.fhir_client:  - headers: {'Cache-Control': 'no-cache, no-store,no-store', 'Pragma': 'no-cache', 'Content-Type': 'application/json; charset=utf-8', 'Expires': '-1', 'Set-Cookie': 'ASP.NET_SessionId=m5g3pj2vfijwe5aghcnqlwzv; path=/Interconnect-fhir-oauth; secure; HttpOnly; SameSite=Lax, EpicPersistenceCookie=!eb4jUwZ9RBfrLtNc5iqg712Vrh0WW4ikNrTPbAX6xXn3d+AO1UbUALww1lg/z0P25HTNRMS/odJRveQ=; path=/; Httponly; Secure', 'ServerMetrics': '{"BlockReads":96,"BlockWrites":21,"BlocksAllocated":2,"DBTime":43,"DatabaseCPUTime":30,"ECFNetworkTime":1,"ECFRequestCount":0,"ECFRequestTime":44,"GREF":2228,"JournalEntries":1,"LockWait":0.055,"LocksFailed":0,"LocksGranted":0,"MCommands":42922,"MemoryDifference":0,"NetworkCacheMisses":0,"NetworkUpdates":0,"WorkflowEventBlockReads":96,"WorkflowEventDBTime":43,"WorkflowEventECFNetworkTime":0,"WorkflowEventECFRequestCount":0,"WorkflowEventGREF":2228}', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains', 'X-Frame-Options': 'sameorigin', 'Access-Control-Allow-Headers': 'origin, authorization, accept, content-type, x-requested-with, prefer, Epic-User-ID, Epic-User-IDType, Epic-Client-ID, soapaction, Epic-MyChartUser-ID, Epic-MyChartUser-IDType', 'Access-Control-Allow-Methods': 'GET, HEAD, POST, PUT, DELETE, TRACE, OPTIONS', 'Access-Control-Allow-Origin': '*', 'Access-Control-Allow-Credentials': 'true', 'Date': 'Sun, 05 Oct 2025 18:45:36 GMT', 'Content-Length': '3408'}
INFO:emr.fhir_client:Successfully exchanged authorization code for Epic access token
INFO:routes.oauth_routes:Epic OAuth flow completed successfully for organization 1
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:37] "GET /oauth/epic-callback?code=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ1cm46b2lkOjEuMi44NDAuMTE0MzUwLjEuMTMuMC4xLjcuMy42ODg4ODQuMTAwIiwiY2xpZW50X2lkIjoiZTU3Mzc3ZTItZGZkNS00Njc1LTk2NTktNThjMzNhYTY3YjNmIiwiZXBpYy5lY2kiOiJ1cm46ZXBpYzpPcGVuLkVwaWMtY3VycmVudCIsImVwaWMubWV0YWRhdGEiOiIzbWkyNndUOVNVbWtGRmpnTmJ1OGJDVlVQMkxtRk1iVDR2X09YRklJdVp0cmJxc3hlQ0FWYzFkNFAzdEhDLUphUXdCVy1mYzhqbVc5S182c25GR2FoeU1pbnRkZmE0ZGh2eFJFNEYxVV9jN2tOWjVJZXhrVDdwRzhWMmZmMEc5YSIsImVwaWMudG9rZW50eXBlIjoiY29kZSIsImV4cCI6MTc1OTY5MDIzNiwiaWF0IjoxNzU5Njg5OTM2LCJpc3MiOiJ1cm46b2lkOjEuMi44NDAuMTE0MzUwLjEuMTMuMC4xLjcuMy42ODg4ODQuMTAwIiwianRpIjoiNDE4ZmNkMDgtZmU0NS00Y2U3LTlkYjYtZDlkMmExOWM2ODdiIiwibmJmIjoxNzU5Njg5OTM2LCJzdWIiOiJlNmF3Ni1SSnVLTzJtYnFqbGVLdmdWUTMifQ.CtCa4N7GPRoXdKMOIuqrZ5t5qXaybgwxWwXeYG7nqYvZCYB20l-_JaQV7o7EHdTX0Pz75y1lDY4wz4I-0x7lG-ZtzQVTLqzqhru7i4okge16BqUOj9YRja6iVQkqzzl6GNqdWH0FJfbBmvGAFaZJc-xaMMe-mB6A9QQqOJA9E8jLSpymUyPjOz8PMWNUl7K5WmV_qe-cllU6lA3mRUCgDUYVhwXcgHCohHWxhNfxNUFD7RqT3bsCWGP_KcJpG0l1wrWI8fs-K_AobQw4KgCeujdlaxAeOrbpBan8mS1AyhE-d3eimXwl509JA7c52qwyCUu7kGM2TRqHU2CVo91maQ&state=DeE-aN5D35EYl-shSv3S1eqnkIgvQuA3JBlN1zFlVio HTTP/1.1" 302 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:37] "GET /admin/epic/registration HTTP/1.1" 200 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:45:38] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:38] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:39] "GET /oauth/epic-status HTTP/1.1" 200 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:45:40] "GET /admin/epic/registration HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:40] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:40] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:40] "GET /oauth/epic-status HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:42] "GET /oauth/epic-status HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:42] "GET /oauth/epic-status HTTP/1.1" 200 -
INFO:emr.fhir_client:Epic FHIR tokens set successfully
INFO:emr.fhir_client:Epic OAuth Parameters:
INFO:emr.fhir_client:  response_type: code
INFO:emr.fhir_client:  client_id: e57377e2-dfd5-4675-9659-58c33aa67b3f
INFO:emr.fhir_client:  redirect_uri: http://localhost:5000/oauth/epic-callback
INFO:emr.fhir_client:  scope: openid fhirUser patient/Patient.read patient/Condition.read patient/Observation.read patient/DocumentReference.read patient/Encounter.read patient/Appointment.read user/Patient.read user/Condition.read user/Observation.read user/DocumentReference.read user/Encounter.read
INFO:emr.fhir_client:  aud: https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4/
INFO:emr.fhir_client:  state: LwoxekiUFMdyWxVL0IO94cENqxyRSa10lY-Bx1Zz6jM
INFO:emr.fhir_client:Generated Epic authorization URL: https://fhir.epic.com/interconnect-fhir-oauth/oauth2/authorize?response_type=code&client_id=e57377e2-dfd5-4675-9659-58c33aa67b3f&redirect_uri=http%3A%2F%2Flocalhost%3A5000%2Foauth%2Fepic-callback&scope=openid+fhirUser+patient%2FPatient.read+patient%2FCondition.read+patient%2FObservation.read+patient%2FDocumentReference.read+patient%2FEncounter.read+patient%2FAppointment.read+user%2FPatient.read+user%2FCondition.read+user%2FObservation.read+user%2FDocumentReference.read+user%2FEncounter.read&aud=https%3A%2F%2Ffhir.epic.com%2Finterconnect-fhir-oauth%2Fapi%2FFHIR%2FR4%2F&state=LwoxekiUFMdyWxVL0IO94cENqxyRSa10lY-Bx1Zz6jM
INFO:routes.epic_registration_routes:Epic connection test successful for organization Default Organization
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:44] "POST /admin/epic/registration/test-connection HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:45] "GET /oauth/epic-status HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:46] "GET /oauth/epic-status HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:51] "GET /auth/logout HTTP/1.1" 302 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:51] "GET /auth/login HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:51] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:45:51] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:51] "GET /static/css/medical_styles.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:45:51] "GET /static/css/medical_terminology_ui.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:51] "GET /static/js/medical_terminology.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:45:59] "POST /auth/login HTTP/1.1" 302 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:00] "GET / HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:00] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:46:00] "GET /static/css/medical_styles.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:00] "GET /static/css/medical_terminology_ui.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.7.90 - - [05/Oct/2025 18:46:00] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:00] "GET /static/js/medical_terminology.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:03] "GET /screening/types HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:03] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.7.90 - - [05/Oct/2025 18:46:03] "GET /static/css/medical_styles.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:46:03] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:03] "GET /static/css/medical_terminology_ui.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:03] "GET /static/js/medical_terminology.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:46:03] "GET /static/css/keyword_modal.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:03] "GET /static/js/screening_modals.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:03] "GET /static/js/condition_modals.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:13] "GET /screening/type/89/edit HTTP/1.1" 200 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:14] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:14] "GET /static/css/medical_terminology_ui.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:46:14] "GET /static/css/medical_styles.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.7.90 - - [05/Oct/2025 18:46:14] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:14] "GET /static/css/keyword_modal.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:14] "GET /static/js/inline_conditions.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.7.90 - - [05/Oct/2025 18:46:14] "GET /static/js/screening_name_autocomplete.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:14] "GET /static/js/medical_terminology.js HTTP/1.1" 304 -
INFO:routes.screening_routes:Screening type Electrocardiogram (ECG) criteria changed - triggering selective refresh
INFO:services.screening_refresh_service:ScreeningRefreshService initialized for organization 1 - LOCAL PROCESSING ONLY
INFO:services.screening_refresh_service:Starting screening refresh for EXISTING data only - NO Epic calls
INFO:services.screening_refresh_service:Found 1 modified screening types
INFO:services.screening_refresh_service:Force refresh requested
ERROR:services.screening_refresh_service:Error updating screening 3: max() arg is an empty sequence
INFO:core.matcher:EXACT MATCHES for Colorectal Cancer Screening: OCR: ['colorectal screening', 'colonoscopy'] -> confidence 0.830
ERROR:services.screening_refresh_service:Error updating screening 16: max() arg is an empty sequence
INFO:core.matcher:EXACT MATCHES for A1C Test: OCR: ['A1C', 'HbA1c'] -> confidence 0.830
ERROR:services.screening_refresh_service:Error updating screening 8: max() arg is an empty sequence
INFO:core.matcher:EXACT MATCHES for Electrocardiogram (ECG): OCR: ['ecg', 'ekg', 'electrocardiogram'] -> confidence 0.860
INFO:services.screening_refresh_service:Screening refresh completed successfully: {'patients_processed': 1, 'screenings_updated': 1, 'documents_reprocessed': 0, 'criteria_changes_detected': 0, 'errors': [], 'start_time': datetime.datetime(2025, 10, 5, 18, 46, 24, 253438), 'end_time': datetime.datetime(2025, 10, 5, 18, 46, 26, 319761)}
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:26] "POST /screening/type/89/edit HTTP/1.1" 302 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:27] "GET /screening/types HTTP/1.1" 200 -
INFO:werkzeug:10.81.7.90 - - [05/Oct/2025 18:46:27] "GET /static/css/medical_styles.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:27] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:46:27] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:27] "GET /static/css/medical_terminology_ui.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:27] "GET /static/css/keyword_modal.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:46:27] "GET /static/js/condition_modals.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.7.90 - - [05/Oct/2025 18:46:27] "GET /static/js/medical_terminology.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:27] "GET /static/js/screening_modals.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:40] "GET /screening/type/92/edit HTTP/1.1" 200 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:46:40] "GET /static/css/medical_styles.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.7.90 - - [05/Oct/2025 18:46:40] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:40] "GET /static/css/medical_terminology_ui.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:40] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:40] "GET /static/css/keyword_modal.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:40] "GET /static/js/inline_conditions.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:40] "GET /static/js/screening_name_autocomplete.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.7.90 - - [05/Oct/2025 18:46:40] "GET /static/js/medical_terminology.js HTTP/1.1" 304 -
INFO:routes.screening_routes:Screening type Diabetic Eye Exam criteria changed - triggering selective refresh
INFO:services.screening_refresh_service:ScreeningRefreshService initialized for organization 1 - LOCAL PROCESSING ONLY
INFO:services.screening_refresh_service:Starting screening refresh for EXISTING data only - NO Epic calls
INFO:services.screening_refresh_service:Found 2 modified screening types
INFO:services.screening_refresh_service:Force refresh requested
ERROR:services.screening_refresh_service:Error updating screening 3: max() arg is an empty sequence
INFO:core.matcher:EXACT MATCHES for Colorectal Cancer Screening: OCR: ['colorectal screening', 'colonoscopy'] -> confidence 0.830
ERROR:services.screening_refresh_service:Error updating screening 16: max() arg is an empty sequence
INFO:core.matcher:EXACT MATCHES for A1C Test: OCR: ['A1C', 'HbA1c'] -> confidence 0.830
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:54] "POST /screening/type/92/edit HTTP/1.1" 302 -
ERROR:services.screening_refresh_service:Error updating screening 8: max() arg is an empty sequence
INFO:core.matcher:EXACT MATCHES for Electrocardiogram (ECG): OCR: ['ecg', 'ekg', 'electrocardiogram'] -> confidence 0.860
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:55] "GET /screening/types HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:55] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:55] "GET /static/css/medical_styles.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:46:55] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:55] "GET /static/css/medical_terminology_ui.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:55] "GET /static/css/keyword_modal.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:46:55] "GET /static/js/screening_modals.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:46:55] "GET /static/js/condition_modals.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:46:55] "GET /static/js/medical_terminology.js HTTP/1.1" 304 -
INFO:services.screening_refresh_service:No screening updates needed - early termination
INFO:werkzeug:10.81.7.90 - - [05/Oct/2025 18:46:55] "POST /screening/type/92/edit HTTP/1.1" 302 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:47:13] "GET /screening/list HTTP/1.1" 200 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:47:13] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:47:13] "GET /static/css/medical_terminology_ui.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:47:13] "GET /static/css/medical_styles.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:47:13] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:47:13] "GET /static/js/screening_modals.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:47:13] "GET /static/js/screening_performance.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:47:13] "GET /static/js/medical_terminology.js HTTP/1.1" 304 -
INFO:services.screening_refresh_service:ScreeningRefreshService initialized for organization 1 - LOCAL PROCESSING ONLY
INFO:services.screening_refresh_service:Starting screening refresh for EXISTING data only - NO Epic calls
INFO:services.screening_refresh_service:Found 2 modified screening types
INFO:services.screening_refresh_service:Force refresh requested
ERROR:services.screening_refresh_service:Error updating screening 3: max() arg is an empty sequence
INFO:core.matcher:EXACT MATCHES for Colorectal Cancer Screening: OCR: ['colorectal screening', 'colonoscopy'] -> confidence 0.830
ERROR:services.screening_refresh_service:Error updating screening 16: max() arg is an empty sequence
INFO:core.matcher:EXACT MATCHES for A1C Test: OCR: ['A1C', 'HbA1c'] -> confidence 0.830
ERROR:services.screening_refresh_service:Error updating screening 8: max() arg is an empty sequence
INFO:core.matcher:EXACT MATCHES for Electrocardiogram (ECG): OCR: ['ecg', 'ekg', 'electrocardiogram'] -> confidence 0.860
INFO:services.screening_refresh_service:No screening updates needed - early termination
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:47:20] "POST /screening/refresh HTTP/1.1" 302 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:47:21] "GET /screening/list HTTP/1.1" 200 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:47:23] "GET /screening/list HTTP/1.1" 200 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:47:23] "GET /static/css/medical_styles.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:47:23] "GET /static/css/custom.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:47:23] "GET /static/css/medical_terminology_ui.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.6.198 - - [05/Oct/2025 18:47:23] "GET /static/css/loading-states.css HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:47:23] "GET /static/js/screening_modals.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.1.75 - - [05/Oct/2025 18:47:23] "GET /static/js/screening_performance.js HTTP/1.1" 304 -
INFO:werkzeug:10.81.0.121 - - [05/Oct/2025 18:47:23] "GET /static/js/medical_terminology.js HTTP/1.1" 304 -