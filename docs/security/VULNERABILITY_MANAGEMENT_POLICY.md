# Vulnerability Management Policy

## Document Control

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | January 2026 | HealthPrep Security Team | Initial release |

**Classification**: Internal Use Only  
**Review Frequency**: Annual  
**Next Review**: January 2027  
**HITRUST CSF Alignment**: Domain 07.a (Asset Management - Vulnerability Management)

---

## 1. Purpose

This policy establishes procedures for identifying, assessing, remediating, and reporting vulnerabilities in HealthPrep systems. It ensures compliance with HIPAA Security Rule (45 CFR 164.308(a)(1)) and HITRUST CSF requirements for vulnerability management.

---

## 2. Scope

This policy applies to:
- HealthPrep application code and dependencies
- Infrastructure components (containers, servers, databases)
- Third-party integrations (Epic FHIR, Stripe, Resend)
- Development, staging, and production environments

---

## 3. Roles and Responsibilities

### 3.1 Security Officer
- Oversee vulnerability management program
- Review vulnerability reports and metrics
- Approve exception requests
- Report to management on program effectiveness

### 3.2 DevOps/Development Team
- Implement and maintain scanning tools
- Remediate identified vulnerabilities
- Update dependencies and apply patches
- Document remediation actions

### 3.3 Management
- Allocate resources for vulnerability remediation
- Approve remediation priorities
- Accept residual risk when appropriate

---

## 4. Vulnerability Identification

### 4.1 Scanning Methods

| Method | Tool | Frequency | Scope |
|--------|------|-----------|-------|
| Static Application Security Testing (SAST) | CodeQL | Every commit | Source code |
| Dependency scanning | pip-audit, safety | Weekly + PR | Python packages |
| Container scanning | AWS ECR, Trivy | Every build | Docker images |
| Infrastructure scanning | AWS Inspector | Weekly | EC2, RDS, containers |
| Dynamic Application Security Testing (DAST) | OWASP ZAP | Monthly | Running application |
| Penetration testing | Third-party | Annually | Full application |

### 4.2 Continuous Integration Scanning

**GitHub Actions Workflow**:
```yaml
name: Security Scan
on: [push, pull_request]

jobs:
  codeql:
    runs-on: ubuntu-latest
    steps:
      - uses: github/codeql-action/init@v2
        with:
          languages: python
      - uses: github/codeql-action/analyze@v2

  dependency-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Install safety
        run: pip install safety pip-audit
      - name: Check dependencies
        run: |
          pip-audit --requirement requirements.txt
          safety check -r requirements.txt
```

### 4.3 External Sources

Vulnerabilities are also identified from:
- National Vulnerability Database (NVD)
- CISA alerts and advisories
- Vendor security bulletins (AWS, Epic, Python)
- Security mailing lists
- Bug bounty program (future)

---

## 5. Vulnerability Classification

### 5.1 Severity Levels

Based on CVSS v3.1 scoring:

| Severity | CVSS Score | Description |
|----------|------------|-------------|
| Critical | 9.0 - 10.0 | Immediate exploitation risk, PHI exposure |
| High | 7.0 - 8.9 | Significant risk, exploitable remotely |
| Medium | 4.0 - 6.9 | Moderate risk, requires user interaction |
| Low | 0.1 - 3.9 | Limited risk, difficult to exploit |
| Informational | 0 | Best practice recommendations |

### 5.2 Context Factors

Severity may be adjusted based on:
- Exposure (internet-facing vs. internal)
- Data sensitivity (PHI involvement)
- Exploitability (public exploit available)
- Compensating controls in place

---

## 6. Remediation Requirements

### 6.1 Remediation Timeframes

| Severity | Initial Response | Remediation Deadline | Escalation |
|----------|------------------|---------------------|------------|
| Critical | 4 hours | 24 hours | Immediate to Security Officer |
| High | 24 hours | 7 days | 3 days to Security Officer |
| Medium | 72 hours | 30 days | 14 days to DevOps Lead |
| Low | 7 days | 90 days | 45 days to DevOps Lead |
| Informational | 30 days | Next release | None |

### 6.2 Remediation Actions

| Action | When Used |
|--------|-----------|
| Patch/Update | Vendor fix available |
| Code fix | Custom code vulnerability |
| Configuration change | Misconfiguration issue |
| Compensating control | Patch not available |
| Accept risk | Low severity, high remediation cost |
| Disable feature | Feature not essential |

### 6.3 Emergency Remediation

For Critical vulnerabilities:
1. Security Officer notified immediately
2. Assess active exploitation indicators
3. Implement emergency patch or workaround
4. Consider temporary service degradation if needed
5. Post-incident review within 48 hours

---

## 7. Vulnerability Tracking

### 7.1 Tracking System

All vulnerabilities are tracked in:
- GitHub Security Advisories (code vulnerabilities)
- Internal vulnerability register (infrastructure)
- JIRA tickets (remediation tasks)

### 7.2 Required Documentation

| Field | Required |
|-------|----------|
| Vulnerability ID (CVE if applicable) | Yes |
| Affected component | Yes |
| Severity (CVSS) | Yes |
| Discovery date | Yes |
| Discovery method | Yes |
| Remediation plan | Yes |
| Remediation deadline | Yes |
| Actual remediation date | Yes |
| Verification of fix | Yes |

### 7.3 Vulnerability Register

| CVE ID | Component | Severity | Discovered | Status | Remediation Date |
|--------|-----------|----------|------------|--------|------------------|
| Example | Example | Example | Example | Example | Example |

---

## 8. Dependency Management

### 8.1 Dependency Policy

| Requirement | Standard |
|-------------|----------|
| Version pinning | Required for all dependencies |
| Known vulnerable versions | Prohibited |
| Update frequency | Monthly minimum |
| Security advisories | Monitor actively |

### 8.2 Dependency Update Process

1. **Weekly automated scan** via pip-audit/safety
2. **Review scan results** within 48 hours
3. **Prioritize updates** by severity
4. **Test updates** in development environment
5. **Deploy updates** per remediation timeline
6. **Document changes** in changelog

### 8.3 Approved Dependency Sources

| Source | Approval |
|--------|----------|
| PyPI (official) | Approved |
| GitHub releases | Case-by-case |
| Vendor CDNs | Approved with SRI |
| Private registries | Security Officer approval |

---

## 9. Penetration Testing

### 9.1 Testing Requirements

| Aspect | Requirement |
|--------|-------------|
| Frequency | Annually minimum |
| Scope | Full application and infrastructure |
| Tester | Independent third party |
| Methodology | OWASP Testing Guide, PTES |
| Report delivery | Within 14 days of completion |

### 9.2 Testing Process

1. **Scope definition** with penetration testing firm
2. **Rules of engagement** documented and signed
3. **Testing window** scheduled (avoid peak hours)
4. **Real-time communication** for critical findings
5. **Final report** with CVSS-scored findings
6. **Remediation plan** within 14 days of report
7. **Verification test** after remediation

### 9.3 Testing Restrictions

- No denial of service testing in production
- No testing of third-party systems (Epic, AWS, Stripe)
- Test data only, no real PHI
- Coordinated disclosure for any findings

---

## 10. Reporting

### 10.1 Internal Reporting

| Report | Frequency | Audience |
|--------|-----------|----------|
| Vulnerability scan summary | Weekly | DevOps team |
| Open vulnerability status | Biweekly | Security Officer |
| Monthly metrics report | Monthly | Management |
| Quarterly trend analysis | Quarterly | Executive team |

### 10.2 Report Metrics

- Total vulnerabilities by severity
- Mean time to remediate (MTTR)
- Vulnerability aging (time open)
- Scan coverage percentage
- Exception count and status

### 10.3 Sample Monthly Report Format

```
VULNERABILITY MANAGEMENT MONTHLY REPORT - [Month Year]

SUMMARY
- Total vulnerabilities discovered: X
- Critical/High remediated: X
- Open vulnerabilities: X (C:X, H:X, M:X, L:X)
- MTTR: X days

NEW VULNERABILITIES
[List of new findings with severity and status]

REMEDIATION COMPLETED
[List of remediated vulnerabilities]

OVERDUE ITEMS
[Any vulnerabilities past SLA]

TRENDS
[Comparison to previous month]

NEXT ACTIONS
[Planned activities for coming month]
```

---

## 11. Exception Management

### 11.1 Exception Criteria

Exceptions may be granted when:
- Remediation causes unacceptable business disruption
- No patch available from vendor
- Compensating controls provide equivalent protection
- Risk is accepted by appropriate authority

### 11.2 Exception Process

1. **Request submission** with justification
2. **Risk assessment** by Security Officer
3. **Compensating controls** identified
4. **Approval authority**:
   - Low/Medium: DevOps Lead
   - High: Security Officer
   - Critical: Management approval required
5. **Time limit** (max 90 days, renewable)
6. **Monitoring plan** during exception period

### 11.3 Exception Documentation

| Field | Required |
|-------|----------|
| Vulnerability details | Yes |
| Business justification | Yes |
| Risk assessment | Yes |
| Compensating controls | Yes |
| Approval authority | Yes |
| Expiration date | Yes |
| Review schedule | Yes |

---

## 12. Third-Party Vulnerabilities

### 12.1 Vendor Monitoring

| Vendor | Monitoring Method |
|--------|-------------------|
| AWS | Security bulletins, AWS Health |
| Epic | App Orchard notifications |
| Python/PyPI | Security advisories, pip-audit |
| Stripe | Security updates, blog |

### 12.2 Response Process

1. Assess applicability to HealthPrep
2. Determine exposure and impact
3. Apply vendor patches per remediation SLA
4. Verify fix in test environment
5. Deploy to production
6. Update documentation

---

## 13. Compliance Verification

### 13.1 Audit Evidence

Maintained for HITRUST/HIPAA audits:
- Scan reports and findings
- Remediation tickets and timelines
- Exception documentation
- Penetration test reports
- Patch management records

### 13.2 Retention

| Record Type | Retention Period |
|-------------|------------------|
| Vulnerability scan reports | 3 years |
| Remediation records | 3 years |
| Penetration test reports | 7 years |
| Exception documentation | 3 years after expiration |

---

## 14. Program Review

### 14.1 Annual Review

The vulnerability management program is reviewed annually for:
- Tool effectiveness
- SLA appropriateness
- Coverage completeness
- Resource adequacy
- Alignment with threat landscape

### 14.2 Continuous Improvement

- Track MTTR trends over time
- Analyze root causes of recurring issues
- Update scanning tools as needed
- Incorporate lessons learned
- Benchmark against industry standards

---

## 15. References

| Document | Location |
|----------|----------|
| NIST SP 800-40 | Patch and Vulnerability Management |
| OWASP Testing Guide | https://owasp.org/www-project-web-security-testing-guide/ |
| CVE Database | https://cve.mitre.org |
| NVD | https://nvd.nist.gov |
| Incident Response Plan | /docs/security/INCIDENT_RESPONSE_PLAN.md |
| System Hardening Standards | /docs/security/SYSTEM_HARDENING_STANDARDS.md |

---

## Document Approval

| Role | Name | Signature | Date |
|------|------|-----------|------|
| Security Officer | [TBD] | | |
| DevOps Lead | [TBD] | | |
| Technical Lead | [TBD] | | |
