# HealthPrep Vulnerability Remediation Log

**Document Purpose:** Track container image and dependency vulnerabilities identified by AWS Inspector, remediation actions taken, and known exceptions for HITRUST compliance evidence.

**Related Documents:**
- `/docs/HITRUST_READINESS.md` - HITRUST readiness checklist
- `/docs/security/dr-drill-log.md` - DR drill execution records
- `Dockerfile` - Container security configuration

---

## Scanning Configuration

| Setting | Value |
|---------|-------|
| Scanning Tool | AWS Inspector v2 |
| Region | us-east-2 |
| Scan Type | ECR Container Image Scanning |
| Scan Frequency | Continuous (on push + daily rescan) |
| First Scan Date | 2026-02-03 |

---

## Vulnerability Summary

### Initial Scan Results (2026-02-03)

| Severity | Count | Status |
|----------|-------|--------|
| HIGH | 4 unique CVEs | Remediated |
| MEDIUM | 6 unique CVEs | Remediated (5) / Accepted Risk (1) |
| INFORMATIONAL | 1 unique CVE | Accepted Risk |

---

## HIGH Severity Findings

### CVE-2026-24049 - wheel

| Field | Value |
|-------|-------|
| Package | wheel (Python) |
| Vulnerable Version | <0.46.2 |
| Fixed Version | 0.46.2 |
| Status | **REMEDIATED** |
| Remediation Date | 2026-02-03 |
| Remediation Action | Updated Dockerfile to upgrade wheel>=0.46.2 with build-time version assertion |
| Evidence | `Dockerfile` lines 62, 71-77 |

### CVE-2025-69419, CVE-2025-69420, CVE-2025-69421 - openssl

| Field | Value |
|-------|-------|
| Package | openssl (Debian) |
| Vulnerable Version | <3.5.4-1~deb13u2 |
| Fixed Version | 0:3.5.4-1~deb13u2 |
| Status | **REMEDIATED** |
| Remediation Date | 2026-02-03 |
| Remediation Action | Added `apt-get upgrade -y` in Dockerfile build and production stages |
| Evidence | `Dockerfile` lines 12, 43 |

### CVE-2026-23949 - jaraco.context

| Field | Value |
|-------|-------|
| Package | jaraco.context (Python) |
| Vulnerable Version | <6.1.0 |
| Fixed Version | 6.1.0 |
| Status | **REMEDIATED** |
| Remediation Date | 2026-02-03 |
| Remediation Action | Updated Dockerfile to upgrade jaraco.context>=6.1.0 with build-time version assertion |
| Evidence | `Dockerfile` lines 62, 71-77 |

---

## MEDIUM Severity Findings

### CVE-2026-22795, CVE-2025-69418, CVE-2025-11187, CVE-2025-15469, CVE-2026-22796, CVE-2025-66199 - openssl

| Field | Value |
|-------|-------|
| Package | openssl (Debian) |
| Vulnerable Version | <3.5.4-1~deb13u2 |
| Fixed Version | 0:3.5.4-1~deb13u2 |
| Status | **REMEDIATED** |
| Remediation Date | 2026-02-03 |
| Remediation Action | Added `apt-get upgrade -y` in Dockerfile build and production stages |
| Evidence | `Dockerfile` lines 12, 43 |

### CVE-2026-25210 - expat

| Field | Value |
|-------|-------|
| Package | libexpat1 (Debian) |
| Vulnerable Version | Current Debian stable |
| Fixed Version | **NotAvailable** |
| Status | **ACCEPTED RISK** |
| Risk Acceptance Date | 2026-02-03 |
| Risk Acceptance Rationale | No fix available from Debian upstream. HealthPrep does not directly parse untrusted XML input; expat is a transitive dependency. Will remediate when Debian releases patch. |
| Monitoring Plan | Check monthly via `apt-cache policy libexpat1` during image builds |
| Risk Owner | Mitchell Fusillo |

---

## INFORMATIONAL Severity Findings

### CVE-2025-7709 - sqlite3

| Field | Value |
|-------|-------|
| Package | sqlite3 (Debian) |
| Severity | INFORMATIONAL |
| Status | **ACCEPTED RISK** |
| Risk Acceptance Rationale | Low severity informational finding. HealthPrep uses PostgreSQL as primary database; sqlite3 is not used for PHI storage. |
| Risk Owner | Mitchell Fusillo |

---

## Dockerfile Security Controls

The following security controls are implemented in the production Dockerfile:

1. **OS Package Updates:** `apt-get upgrade -y` applied in both build and production stages
2. **Python Package Upgrades:** pip, wheel, setuptools upgraded before and after requirements install
3. **CVE-Specific Patches:** Explicit upgrade of wheel>=0.46.2 and jaraco.context>=6.1.0
4. **Build-Time Verification:** Python assertions fail build if security package versions are insufficient
5. **Non-Root User:** Application runs as `healthprep` user, not root
6. **Minimal Image:** Development files removed from production image
7. **Health Checks:** Container health endpoint for orchestration monitoring

---

## Verification Process

After deploying updated Docker image:

1. Push Dockerfile changes to GitHub (`git push origin main`)
2. GitHub Actions builds and pushes new image to ECR
3. ECS deploys new task definition with updated image
4. AWS Inspector automatically rescans ECR image
5. Verify findings resolved via:
   ```bash
   aws inspector2 list-findings --region us-east-2 \
     --query 'findings[?severity==`HIGH`].[title]' --output table
   ```

---

## Remediation History

| Date | Action | Performed By | Result |
|------|--------|--------------|--------|
| 2026-02-03 | Initial AWS Inspector scan | Mitchell Fusillo | 4 HIGH, 6 MEDIUM, 1 INFO findings |
| 2026-02-03 | Dockerfile security updates | Mitchell Fusillo | Patched wheel, jaraco.context, openssl CVEs |
| 2026-02-03 | Risk acceptance for expat CVE | Mitchell Fusillo | Documented, no upstream fix available |

---

## Next Scheduled Actions

| Action | Target Date | Owner |
|--------|-------------|-------|
| Rebuild and deploy patched image | 2026-02-03 | Mitchell Fusillo |
| Verify Inspector findings resolved | After deployment | Mitchell Fusillo |
| Check for expat patch availability | 2026-03-01 | Mitchell Fusillo |
| Monthly vulnerability review | 2026-03-03 | Mitchell Fusillo |

---

## Revision History

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 2026-02-03 | Mitchell Fusillo | Initial vulnerability remediation log |
